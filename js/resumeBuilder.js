var bio = {
  "name"    : "Benjamin Warren",
  "role"    : "Senior Analyst Developer (and Stay-at-home Dad)",
  "biopic"  : "images/meAndFam.jpg",
  "welcomeMessage"  : "Thanks for taking the time to read my resume.",
  "skills"  : [
      "SQL",
      "JavaSript",
      "HTML",
      "SharePoint",
      "T-SQL",
      "Teradata SQL",
      "Git/GitHub",
      "MS Office suite",
      "VBA",
      "Requirements Analysis",
      "Databases",
      "Database Design",
      "Business Intelligence",
      "SDLC"
  ],
  "contacts": {
      "mobile"  : "0421035676",
      "email"   : "benjaminpwarren+udacity@gmail.com",
      "github"  : "benjaminpwarren",
      "twitter" : "@benjaminpwarren",
      "location": "Newcastle, NSW, Australia"
  }
};

var work = {
  "jobs":[
    {
      "employer": "Domino's Pizza",
      "title"   : "Delivery Driver",
      "location": "Newcastle, NSW, Australia",
      "dates"   : "1999-2000 (1 year)",
      "description": "Delivered pizzas, prepped dough, cleaned, ran dispatch, and helped close-up."
    },
    {
      "employer": "OzEmail",
      "title"   : "Technical Support Officer",
      "location": "Sydney, NSW, Australia",
      "dates"   : "April 2000 - August 2000 (5 months)",
      "description": "Provided technical support for customers with internet connectivity and configuration issues (connection, authentication, software support). (In the days of dial-up!)"
    },
    {
      "employer": "TeleTech",
      "title"   : "Customer Service Officer",
      "location": "Newcastle, NSW, Australia",
      "dates"   : "March 2001 - October 2001 (8 months)",
      "description": "Booked domestic flights, cars, and accommodation for Qantas Frequent Flyer customers."
    },
    {
      "employer": "TeleTech",
      "title"   : "Intranet Developer",
      "location": "Newcastle, NSW, Australia",
      "dates"   : "October 2001 - August 2002 (11 months)",
      "description": "Developed and maintained an Activity & Call Disposition system with reporting using classic ASP, HTML, JavaScript, and MS Excel."
    },
    {
      "employer": "Commonwealth Bank of Australia",
      "title"   : "Customer Service Officer",
      "location": "Newcastle, NSW, Australia",
      "dates"   : "August 2002 - May 2004 (1 year 10 months)",
      "description": "Helped customers with general banking and credit card enquiries."
    },
    {
      "employer": "Child Support Agency",
      "title"   : "Customer Service Officer",
      "location": "Newcastle, NSW, Australia",
      "dates"   : "May 2004 - March 2005 (11 months)",
      "description": "Assessed and managed Child Support (maintenance) customers' cases, collected unpaid maintenance, and negotiated and monitored payment arrangements. Primarily via phone but with some face-to-face customer contact."
    },
    {
      "employer": "Child Support Agency",
      "title"   : "Business Analyst (NSW)",
      "location": "Newcastle, NSW, Australia",
      "dates"   : "March 2005 - November 2006 (1 year 9 months)",
      "description": "Developed reporting, workload delivery, and automation systems using HTML, JavaScript, and VBA."
    },
    {
      "employer": "Child Support Agency",
      "title"   : "Business Analyst",
      "location": "Canberra, ACT, Australia",
      "dates"   : "November 2006 - April 2009 (2 years 6 months)",
      "description": "Targetted customer selection for workload delivery using T-SQL, and report development using Cognos, T-SQL, and VBA."
    },
    {
      "employer": "Department of Human Services",
      "title"   : "Senior Business Analyst",
      "location": "Canberra, ACT, Australia",
      "dates"   : "April 2009 - December 2011 (2 years 9 months)",
      "description": "Managed staff and performed targetted customer selection for workload delivery using T-SQL, and report development using Cognos, T-SQL, and VBA."
    },
    {
      "employer": "Australian Prudential Regulation Authority",
      "title"   : "Contract Developer",
      "location": "Canberra, ACT, Australia",
      "dates"   : "December 2009 - November 2011 (1 year, 11 months)",
      "description": "Developed decision review system (MS Access) and a mobile quality assurance recording system (Windows Mobile 6)"
    },
    {
      "employer": "Department of Human Services",
      "title"   : "Senior Project Officer",
      "location": "Newcastle, NSW, Australia",
      "dates"   : "December 2011 - June 2012 (7 months)",
      "description": "Managed staff and developed workload capacity (workload vs. staffing etc) forecasting processes and tools. Developed and implemented strategies to increase capacity and decrease workload.

Forecasting was performed using R."
    },
    {
      "employer": "Department of Human Services",
      "title"   : "Senior Business Analyst / Developer, Assistant Director",
      "location": "Brisbane, Qld, Australia",
      "dates"   : "July 2012 - September 2013 (1 year 3 months)",
      "description": "Responded to ad hoc data requests. Data sourced using primarily T-SQL and provided with detailed documentation and guidance."
    },
    {
      "employer": "Department of Human Services",
      "title"   : "Acting Director",
      "location": "Brisbane, Qld, Australia",
      "dates"   : "January 2013 - March 2013 (3 months)",
      "description": "Managed a section of 25 ex-Child Support, ex-Medicare, and ex-Centrelink staff in our Information Management division."
    },
    {
      "employer": "Department of Human Services",
      "title"   : "Senior Analyst / Developer, Assistant Director",
      "location": "Brisbane, Qld, Australia",
      "dates"   : "September 2013 - June 2014 (10 months)(moved to Newcastle and continued role)",
      "description": "Development and maintenance of our internal division workload management system using SharePoint with forms customised using JavaScript and HTML."
    },
    {
      "employer": "Department of Human Services",
      "title"   : "Acting Director",
      "location": "Brisbane, Qld, Australia",
      "dates"   : "October 2013 - December 2013 (3 months)(concurrent with other role)",
      "description": "Established and managed a quality, learning, and development team to improve the quality of the division through staff training, knowledge sharing, and quality assurance."
    },
    {
      "employer": "Department of Human Services",
      "title"   : "Senior Project Officer",
      "location": "Brisbane, Qld, Australia",
      "dates"   : "January 2014 - June 2014 (1 year)(concurrent with other role)",
      "description": "Provided expert knowledge of our CRM's data and data structures to facilate migration to a replacement system."
    },
    {
      "employer": "Department of Human Services",
      "title"   : "Senior Analyst / Developer, Assistant Director",
      "location": "Newcastle, NSW, Australia",
      "dates"   : "September 2013 - Present",
      "description": "Development and maintenance of our internal division workload management system using SharePoint with forms customised using JavaScript and HTML."
    }
  ]
};

var education = {
  "schools": [
    {
      "name"    : "Wallsend South Public School",
      "location": "Elermore Vale, NSW, Australia",
      "degree"  : "Primary",
      "majors"  : "",
      "dates"   : 1987,
      "url"     : "http://www.wallsends-p.schools.nsw.edu.au/"
    },
    {
      "name"    : "Moree Public School",
      "location": "Moree, NSW, Australia",
      "degree"  : "Primary",
      "majors"  : "",
      "dates"   : 1988,
      "url"     : "http://www.moree-p.schools.nsw.edu.au/"
    },
    {
      "name"    : "Brooklyn Public School",
      "location": "Brooklyn, NSW, Australia",
      "degree"  : "Primary",
      "majors"  : "",
      "dates"   : 1989,
      "url"     : "http://www.brooklyn-p.schools.nsw.edu.au/"
    },
    {
      "name"    : "Charlestown East Public School",
      "location": "Charlestown, NSW, Australia",
      "degree"  : "Primary",
      "majors"  : "",
      "dates"   : 1989,
      "url"     : "http://www.charlestoe-p.schools.nsw.edu.au/"
    },
    {
      "name"    : "Cardiff Public School",
      "location": "Cardiff, NSW, Australia",
      "degree"  : "Primary",
      "majors"  : "",
      "dates"   : 1993,
      "url"     : "http://cardiffpublicschool.com/"
    },
    {
      "name"    : "Merewether High School",
      "location": "Broadmeadow, NSW, Australia",
      "degree"  : "Secondary",
      "majors"  : "",
      "dates"   : 1999,
      "url"     : "http://www.merewether-h.schools.nsw.edu.au/"
    }
  ],
  "onlineCourses" : [
    {
      "title": "Front-End Web Developer Nanodegree",
      "school": "Udacity",
      "date"  : 2015,
      "url"   : "https://www.udacity.com/course/nd001"
    },
    {
      "title": "JavaScript Basics",
      "school": "Udacity",
      "date"  : 2015,
      "url"   : "https://www.udacity.com/course/ud804"
    },
    {
      "title": "How to Use Git and GitHub",
      "school": "Udacity",
      "date"  : 2015,
      "url"   : "https://www.udacity.com/course/ud775"
    }
  ]
};

var projects = {
  "projects": [
    {
      "title": "P1: Mockup to Web Site",
      "dates": "2015-02-01 - 2015-02-13",
      "description": "Built a website based on the provided mockup.",
      "images": ["images/p1-mock-web_300.jpg"]
    },
    {
      "title": "P2: Interactive Resume",
      "dates": "2015-03-10 - 2015-03-15",
      "description": "Built an interactive resume.",
      "images": ["images/p2-resume.jpg", "images/p2-resume-2.jpg"]
    }
  ]
};

bio.display = function(){

  if (bio.skills.length) {

    var $header = $("#header").hide(); //hide header while we"re adding stuff to it.
    var $bio1 = $("#bio1").first();
    var $topContacts = $("#topContacts");
    var $skillsBox = $("#skillsBox")

    //name, role, biopic, welcome message
    var formattedName = HTMLheaderName.replace("%data%", bio.name);
    var formattedRole = HTMLheaderRole.replace("%data%", bio.role);
    var formattedBioPic = HTMLbioPic.replace("%data%", bio.biopic);
    var formattedWelcomeMsg = HTMLwelcomeMsg.replace("%data%", bio.welcomeMessage);

    $bio1.append(formattedName);
    $bio1.append(formattedRole);

    $bio1.append([formattedBioPic, formattedWelcomeMsg]);

    //skills
    var displaySkills = (function(){
      $skillsBox.append(HTMLskillsStart);

      var $skills = $("#skills");
      $.each(bio.skills, function(index, value){
        $skills.append(HTMLskills.replace("%data%", value.replace(" ", "&nbsp;")));
      });
    })();

    //contacts
    $.each(bio.contacts, function(name, value){

      switch (name) {
        case "mobile":
          $topContacts.append(HTMLmobile.replace("%data%", value));
          break;
        case "email":
          $topContacts.append(HTMLemail.replace("%data%", value));
          break;
        case "twitter":
          $topContacts.append(HTMLtwitter.replace("%data%", value));
          break;
        case "github":
          $topContacts.append(HTMLgithub.replace("%data%", value));
          break;
        case "blog":
          $topContacts.append(HTMLblog.replace("%data%", value));
          break;
        case "location":
          $topContacts.append(HTMLlocation.replace("%data%", value));
          break;
        default:
          $topContacts.append(HTMLcontactGeneric.replace("%contact%", name).replace("%data%", value));
          break;
      };

    });

    $('#footerContacts').append($topContacts.children().clone());

    $header.show(); //show header now we"re finished adding to it.
  };
};

work.display = function(){
  var $workExperience = $("#workExperience").hide();

  $.each(work.jobs.reverse(), function(index, value){
    var job = value;
    var $workEntry = $(HTMLworkStart);

    var $employerLink = $(HTMLworkEmployer.replace("%data%", job.employer) + HTMLworkTitle.replace("%data%", job.title));
    $workEntry.append($("<div></div>").append($employerLink));

    $workEntry.append(HTMLworkDates.replace("%data%", job.dates));
    $workEntry.append(HTMLworkLocation.replace("%data%", job.location));
    $workEntry.append(HTMLworkDescription.replace("%data%", job.description));

    $workExperience.append($workEntry);
  });

  //Show More option
  $workExperience.find(".work-entry:gt(3)").hide();

  var $showMore = '<a href="#" id="showMoreJobs" class="showMore">>Show more...</a>';
  $workExperience.append($(HTMLworkStart).append($showMore));

  $("#showMoreJobs").on("click", function(){
    $(".work-entry").show();
    $(this).remove();
  });

  $workExperience.show();
};

education.display = function(){
  var $education = $("#education").hide();

  //schools
  $.each(education.schools.reverse(), function(index, value){
    var school = value;
    var $educationEntry = $(HTMLschoolStart);

    var $schoolNameLink = $(HTMLschoolName.replace("%data%", school.name) + HTMLschoolDegree.replace("%data%", school.degree));
    $schoolNameLink.attr("href", school.url).attr("target", "_blank");
    $educationEntry.append($("<div></div>").append($schoolNameLink));

    $educationEntry.append(HTMLschoolDates.replace("%data%", school.dates));
    $educationEntry.append(HTMLschoolLocation.replace("%data%", school.location));

    //since I haven't attended university/college, I have no majors.
    //$educationEntry.append(HTMLschoolMajor.replace("%data%", school.major || "N/A"));

    //adding this as the HTMLschoolMajor stub had a BR which achieved the same effect.
    $educationEntry.append("<div style='clear:both'></div>");

    $education.append($educationEntry);
  });

  //online courses
  if (education.onlineCourses.length){

    $education.append(HTMLonlineClasses);

    $.each(education.onlineCourses, function(index, value){
      var onlineCourse = value;
      var $educationEntry = $(HTMLschoolStart);

      var $onlineTitleLink = $(HTMLonlineTitle.replace("%data%", onlineCourse.title) + HTMLonlineSchool.replace("%data%", onlineCourse.school));
      $onlineTitleLink.attr("href", onlineCourse.url).attr("target", "_blank");
      $educationEntry.append($("<div></div>").append($onlineTitleLink));

      $educationEntry.append(HTMLonlineDates.replace("%data%", onlineCourse.date));
      $educationEntry.append($('<p></p>').append(HTMLonlineURL.replace("%data%", onlineCourse.url)));

      $education.append($educationEntry);
    });

  };

  $education.show();
};

projects.display = function(){
  var $projects = $("#projects").hide();

  $.each(projects.projects.reverse(), function(index, value){
    var project = value;
    var $projectEntry = $(HTMLprojectStart);

    $projectEntry.append($("<div></div>").append(HTMLprojectTitle.replace("%data%", project.title)));
    $projectEntry.append(HTMLprojectDates.replace("%data%", project.dates));
    $projectEntry.append(HTMLprojectDescription.replace("%data%", project.description));

    if (project.images.length) {
      for (var iImage = 0, iImages = project.images.length; iImage < iImages; iImage++){
        var $projectImage = $(HTMLprojectImage.replace("%data%", project.images[iImage]));
        $projectEntry.append($projectImage);
      }
    }

    $projects.append($projectEntry);
  });

  $projects.show();
};

function inName(namesStr){
  if (namesStr) {
    var names = namesStr.trim().split(" ");
    names[0] = names[0][0].toUpperCase() + names[0].slice(1).toLowerCase();
    names[1] = names[1].toUpperCase();
    return names.join(" ");
  } else {
    return false;
  }
}

function locationizer(work){
  return work.jobs.map(function(obj){
    return obj.location;
  });
}

bio.display();
work.display();
education.display();
projects.display();

$("#mapDiv").append(googleMap);

//fix bootstrap navbar not closing after click in collapsed views.
$('.nav a').on('click', function(){
  $(".navbar-toggle").click() //bootstrap 3.x by Richard
});
